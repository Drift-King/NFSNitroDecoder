# Need For Speed Nitro Audio Decoder

At some point I'll flesh out this readme, but for now here are some random important-ish notes for anyone using this:
 * All of this code was reverse-engineered with the help of Dolphin's debugger - huge, huge thanks to the wonderful Dolphin developers, and in particular those that worked on the debugger.
 * NFS: Nitro has two versions of each song - one in a file called FE_COMMON_STR.ast (which also contains some other audio files) and one in a folder named PFData (each folder in PFData contains 4 files, but the only relevant ones are the .mus files and they contain the exact same audio data). The FE_COMMON_STR.ast version play in the "Soundtrack" menu of the options, and the PFData versions play during races. Some songs' versions are only slightly different, and some moreso. It seems like in all cases there is a slight difference in mixing or equalization or something like that. Some songs also have extended outros or intros. Maybe there's other differences - I haven't carefully examined each song. Regardless, this program can extract both of them.
  * For some reason the PFData files are divided into 51 separate parts - all of them are exactly the same length except for the first and the last part, and the second to last is always some sound effect (the exact same one in all songs but I don't know what it's from). If you convert a PFData song, the program spits out all 51 parts and also a stiched-together version (without part 50, obviously).
 * To ensure that this algorithm is accurate, I downloaded the Dolphin source and modified it to save any song data the game generated to a file, then played the game for a bit. testdata.raw contains all of this generated data (shuffled around just in case lengthy snippets of songs would violate copyright laws or something) and the `VerifyConversionAlgorithm` method compares the test data to the output of my program. I will try to test it every time I commit, but just in case I forget or the floating point math works out differently on different machines or something, you can run the test yourself with the `--verify-algorithm` command.
 * There are also some other AST files on the disk - this program can extract those as well.
 * I have no idea what the algorithm is doing conceptually. I just converted the PowerPC instructions to C# but beyond that I don't know why it's doing what it's doing. I'll take a look though (or ask someone with more experience) and if I figure it out I'll update this readme.
